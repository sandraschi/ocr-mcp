<div class="content-section">
    <div class="page-header">
        <h1><i class="fas fa-magic"></i> Image Preprocessing</h1>
        <p>Enhance image quality before OCR processing with advanced image manipulation tools.</p>
    </div>

    <div class="preprocessing-workspace">
        <!-- Image Upload -->
        <div class="preprocessing-upload">
            <div class="upload-area" id="preprocessing-upload-area">
                <div class="upload-content">
                    <i class="fas fa-image"></i>
                    <h3>Upload image for preprocessing</h3>
                    <p>Supports JPG, PNG, TIFF, BMP</p>
                    <input type="file" id="preprocessing-file-input" accept=".png,.jpg,.jpeg,.tiff,.bmp" style="display: none;">
                    <button class="btn btn-primary" onclick="document.getElementById('preprocessing-file-input').click()">
                        <i class="fas fa-folder-open"></i> Choose Image
                    </button>
                </div>
            </div>
        </div>

        <!-- Preprocessing Tools -->
        <div class="preprocessing-tools" id="preprocessing-tools" style="display: none;">
            <div class="tools-header">
                <h3>Preprocessing Tools</h3>
                <div class="tool-controls">
                    <button class="btn btn-outline" onclick="resetImage()">
                        <i class="fas fa-undo"></i> Reset
                    </button>
                    <button class="btn btn-primary" onclick="applyAllPreprocessing()">
                        <i class="fas fa-play"></i> Apply All
                    </button>
                </div>
            </div>

            <div class="tools-grid">
                <div class="tool-card" data-tool="deskew">
                    <div class="tool-icon">
                        <i class="fas fa-compass"></i>
                    </div>
                    <div class="tool-content">
                        <h4>Deskew</h4>
                        <p>Straighten rotated images automatically</p>
                        <div class="tool-controls">
                            <label><input type="checkbox" id="auto-deskew" checked> Auto-detect</label>
                            <button class="btn btn-sm btn-outline" onclick="applyPreprocessing('deskew')">
                                Apply
                            </button>
                        </div>
                    </div>
                </div>

                <div class="tool-card" data-tool="enhance">
                    <div class="tool-icon">
                        <i class="fas fa-sun"></i>
                    </div>
                    <div class="tool-content">
                        <h4>Enhance Quality</h4>
                        <p>Improve contrast and sharpness</p>
                        <div class="tool-controls">
                            <label>Intensity: <input type="range" min="0.1" max="3.0" step="0.1" value="1.0" id="enhance-intensity"></label>
                            <button class="btn btn-sm btn-outline" onclick="applyPreprocessing('enhance')">
                                Apply
                            </button>
                        </div>
                    </div>
                </div>

                <div class="tool-card" data-tool="crop">
                    <div class="tool-icon">
                        <i class="fas fa-crop"></i>
                    </div>
                    <div class="tool-content">
                        <h4>Auto-Crop</h4>
                        <p>Remove borders and margins</p>
                        <div class="tool-controls">
                            <label><input type="checkbox" id="auto-crop" checked> Auto-detect</label>
                            <label>Margin: <input type="range" min="0" max="50" value="10" id="crop-margin">px</label>
                            <button class="btn btn-sm btn-outline" onclick="applyPreprocessing('crop')">
                                Apply
                            </button>
                        </div>
                    </div>
                </div>

                <div class="tool-card" data-tool="rotate">
                    <div class="tool-icon">
                        <i class="fas fa-undo"></i>
                    </div>
                    <div class="tool-content">
                        <h4>Rotate</h4>
                        <p>Fix image orientation</p>
                        <div class="tool-controls">
                            <label>Angle: <input type="range" min="-180" max="180" value="0" id="rotate-angle">Â°</label>
                            <button class="btn btn-sm btn-outline" onclick="applyPreprocessing('rotate')">
                                Apply
                            </button>
                        </div>
                    </div>
                </div>

                <div class="tool-card" data-tool="noise">
                    <div class="tool-icon">
                        <i class="fas fa-wind"></i>
                    </div>
                    <div class="tool-content">
                        <h4>Noise Reduction</h4>
                        <p>Remove noise and artifacts</p>
                        <div class="tool-controls">
                            <label>Strength: <input type="range" min="1" max="10" value="5" id="noise-strength"></label>
                            <button class="btn btn-sm btn-outline" onclick="applyPreprocessing('noise')">
                                Apply
                            </button>
                        </div>
                    </div>
                </div>

                <div class="tool-card" data-tool="binarize">
                    <div class="tool-icon">
                        <i class="fas fa-adjust"></i>
                    </div>
                    <div class="tool-content">
                        <h4>Binarization</h4>
                        <p>Convert to black and white</p>
                        <div class="tool-controls">
                            <label>Threshold: <input type="range" min="0" max="255" value="128" id="binarize-threshold"></label>
                            <button class="btn btn-sm btn-outline" onclick="applyPreprocessing('binarize')">
                                Apply
                            </button>
                        </div>
                    </div>
                </div>

                <div class="tool-card" data-tool="scale">
                    <div class="tool-icon">
                        <i class="fas fa-expand"></i>
                    </div>
                    <div class="tool-content">
                        <h4>Resize</h4>
                        <p>Change image dimensions</p>
                        <div class="tool-controls">
                            <label>Scale: <input type="range" min="25" max="400" value="100" id="scale-percent">%</label>
                            <button class="btn btn-sm btn-outline" onclick="applyPreprocessing('scale')">
                                Apply
                            </button>
                        </div>
                    </div>
                </div>

                <div class="tool-card" data-tool="pipeline">
                    <div class="tool-icon">
                        <i class="fas fa-list-check"></i>
                    </div>
                    <div class="tool-content">
                        <h4>Full Pipeline</h4>
                        <p>All preprocessing steps</p>
                        <div class="tool-controls">
                            <button class="btn btn-sm btn-primary" onclick="applyPreprocessing('pipeline')">
                                Run All
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Before/After Comparison -->
        <div class="comparison-view" id="comparison-view" style="display: none;">
            <div class="comparison-header">
                <h3>Before & After Comparison</h3>
                <div class="comparison-controls">
                    <button class="btn btn-sm" onclick="toggleSplitView()">
                        <i class="fas fa-columns"></i> Split View
                    </button>
                    <button class="btn btn-sm" onclick="downloadProcessedImage()">
                        <i class="fas fa-download"></i> Download Result
                    </button>
                    <button class="btn btn-sm" onclick="resetComparison()">
                        <i class="fas fa-times"></i> Close
                    </button>
                </div>
            </div>

            <div class="comparison-images">
                <div class="image-panel">
                    <h4>Original</h4>
                    <img id="original-image" alt="Original image" style="max-width: 100%; border: 1px solid #ddd;">
                </div>
                <div class="image-panel">
                    <h4>Processed</h4>
                    <img id="processed-image" alt="Processed image" style="max-width: 100%; border: 1px solid #ddd;">
                </div>
            </div>

            <div class="processing-metrics" id="processing-metrics">
                <div class="metrics-grid">
                    <div class="metric">
                        <span class="metric-label">Processing Time:</span>
                        <span class="metric-value" id="processing-time">-</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Image Size:</span>
                        <span class="metric-value" id="image-size">-</span>
                    </div>
                    <div class="metric">
                        <span class="metric-label">Quality Score:</span>
                        <span class="metric-value" id="quality-score">-</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Processing History -->
        <div class="processing-history" id="processing-history" style="display: none;">
            <h3>Processing History</h3>
            <div id="history-list" class="history-list">
                <!-- Processing steps will be listed here -->
            </div>
        </div>
    </div>
</div>