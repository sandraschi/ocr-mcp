<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCR-MCP Professional Document Processing</title>
    <link rel="stylesheet" href="/static/css/style.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism.min.css">
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.1/dist/mermaid.min.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Top Navigation Bar -->
        <nav class="top-nav">
            <div class="nav-brand">
                <i class="fas fa-brain"></i>
                <span>OCR-MCP Professional</span>
            </div>
            <div class="nav-status">
                <span class="status-indicator" id="system-status">
                    <i class="fas fa-circle-notch fa-spin"></i>
                    Initializing...
                </span>
            </div>
            <div class="nav-actions">
                <button class="nav-btn" onclick="showHelp()">
                    <i class="fas fa-question-circle"></i>
                </button>
                <button class="nav-btn" onclick="showSettings()">
                    <i class="fas fa-cog"></i>
                </button>
            </div>
        </nav>

        <!-- Main Application Layout -->
        <div class="main-layout">
            <!-- Sidebar Navigation -->
            <aside class="sidebar">
                <nav class="sidebar-nav">
                    <div class="nav-section">
                        <h3><i class="fas fa-file-upload"></i> Input</h3>
                        <a href="#" class="nav-link active" onclick="showSection('upload')">
                            <i class="fas fa-upload"></i> Single Document
                        </a>
                        <a href="#" class="nav-link" onclick="showSection('batch')">
                            <i class="fas fa-layer-group"></i> Batch Processing
                        </a>
                        <a href="#" class="nav-link" onclick="showSection('scanner')">
                            <i class="fas fa-print"></i> Scanner Control
                        </a>
                    </div>

                    <div class="nav-section">
                        <h3><i class="fas fa-tools"></i> Processing</h3>
                        <a href="#" class="nav-link" onclick="showSection('preprocessing')">
                            <i class="fas fa-magic"></i> Image Preprocessing
                        </a>
                        <a href="#" class="nav-link" onclick="showSection('analysis')">
                            <i class="fas fa-search-plus"></i> Document Analysis
                        </a>
                        <a href="#" class="nav-link" onclick="showSection('quality')">
                            <i class="fas fa-chart-line"></i> Quality Assessment
                        </a>
                    </div>

                    <div class="nav-section">
                        <h3><i class="fas fa-cogs"></i> Workflows</h3>
                        <a href="#" class="nav-link" onclick="showSection('pipelines')">
                            <i class="fas fa-project-diagram"></i> Custom Pipelines
                        </a>
                        <a href="#" class="nav-link" onclick="showSection('optimization')">
                            <i class="fas fa-tachometer-alt"></i> Auto-Optimization
                        </a>
                    </div>

                    <div class="nav-section">
                        <h3><i class="fas fa-exchange-alt"></i> Conversion</h3>
                        <a href="#" class="nav-link" onclick="showSection('conversion')">
                            <i class="fas fa-file-export"></i> Format Conversion
                        </a>
                        <a href="#" class="nav-link" onclick="showSection('export')">
                            <i class="fas fa-download"></i> Export & Download
                        </a>
                    </div>
                </nav>

                <!-- System Health Panel -->
                <div class="system-health">
                    <h4>System Health</h4>
                    <div class="health-metrics">
                        <div class="metric">
                            <span class="metric-label">OCR Backends:</span>
                            <span class="metric-value" id="backend-count">-</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Active Jobs:</span>
                            <span class="metric-value" id="active-jobs">0</span>
                        </div>
                        <div class="metric">
                            <span class="metric-label">Memory Usage:</span>
                            <span class="metric-value" id="memory-usage">-</span>
                        </div>
                    </div>
                </div>
            </aside>

            <!-- Main Content Area -->
            <main class="main-content">

            <!-- Single Document Upload Section -->
            <section id="upload-section" class="content-section active">
                <div class="section-header">
                    <h2><i class="fas fa-file-upload"></i> Single Document Processing</h2>
                    <p>Upload and process individual documents with advanced OCR and analysis</p>
                </div>

                <div class="processing-workflow">
                    <!-- Step 1: Upload -->
                    <div class="workflow-step active" id="step-upload">
                        <div class="step-header">
                            <span class="step-number">1</span>
                            <h3>Upload Document</h3>
                        </div>
                        <div class="upload-zone" id="upload-zone">
                            <div class="upload-content">
                                <i class="fas fa-cloud-upload-alt upload-icon"></i>
                                <h3>Drop files here or click to browse</h3>
                                <p>Supports PDF, CBZ, CBR, JPG, PNG, TIFF, BMP, WebP</p>
                                <div class="upload-actions">
                                    <button class="btn btn-primary" onclick="document.getElementById('file-input').click()">
                                        <i class="fas fa-folder-open"></i> Browse Files
                                    </button>
                                    <button class="btn btn-secondary" onclick="showRecentFiles()">
                                        <i class="fas fa-history"></i> Recent Files
                                    </button>
                                </div>
                                <input type="file" id="file-input" multiple accept=".pdf,.cbz,.cbr,.jpg,.jpeg,.png,.tiff,.bmp,.webp" style="display: none;">
                            </div>
                            <div class="upload-progress" id="upload-progress" style="display: none;">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="upload-progress-fill"></div>
                                </div>
                                <div class="progress-text" id="upload-progress-text">Uploading...</div>
                            </div>
                        </div>

                        <!-- Enhanced File Queue -->
                        <div class="file-queue" id="file-queue" style="display: none;">
                            <div class="queue-header">
                                <h4><i class="fas fa-list"></i> Files to Process</h4>
                                <div class="queue-actions">
                                    <button class="btn btn-sm btn-outline" onclick="clearFileQueue()">
                                        <i class="fas fa-trash"></i> Clear All
                                    </button>
                                    <button class="btn btn-sm btn-primary" onclick="selectAllFiles()">
                                        <i class="fas fa-check-square"></i> Select All
                                    </button>
                                </div>
                            </div>
                            <div class="queue-list" id="queue-list">
                                <!-- Files will be added here dynamically -->
                            </div>
                            <div class="queue-footer">
                                <div class="queue-stats">
                                    <span id="queue-count">0 files</span>
                                    <span id="queue-size">0 MB</span>
                                </div>
                                <div class="queue-controls">
                                    <button class="btn btn-outline" onclick="removeSelectedFiles()">
                                        <i class="fas fa-minus"></i> Remove Selected
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- File Preview Modal -->
                        <div class="modal" id="file-preview-modal" style="display: none;">
                            <div class="modal-backdrop" onclick="closeFilePreview()"></div>
                            <div class="modal-content file-preview-content">
                                <div class="modal-header">
                                    <h3><i class="fas fa-eye"></i> File Preview</h3>
                                    <button class="modal-close" onclick="closeFilePreview()">
                                        <i class="fas fa-times"></i>
                                    </button>
                                </div>
                                <div class="modal-body">
                                    <div class="file-info" id="file-info">
                                        <!-- File information will be displayed here -->
                                    </div>
                                    <div class="file-preview-area" id="file-preview-area">
                                        <!-- File preview will be displayed here -->
                                    </div>
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-outline" onclick="closeFilePreview()">Close</button>
                                    <button class="btn btn-primary" onclick="processPreviewFile()">
                                        <i class="fas fa-play"></i> Process This File
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Step 2: Preprocessing -->
                    <div class="workflow-step" id="step-preprocess">
                        <div class="step-header">
                            <span class="step-number">2</span>
                            <h3>Image Preprocessing</h3>
                        </div>
                        <div class="preprocessing-options">
                            <div class="preprocess-controls">
                                <div class="control-group">
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="preprocess-deskew" checked>
                                        <span class="checkmark"></span>
                                        Deskew (straighten)
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="preprocess-enhance" checked>
                                        <span class="checkmark"></span>
                                        Enhance quality
                                    </label>
                                    <label class="checkbox-label">
                                        <input type="checkbox" id="preprocess-crop" checked>
                                        <span class="checkmark"></span>
                                        Auto-crop borders
                                    </label>
                                </div>
                                <button class="btn btn-outline" onclick="previewPreprocessing()">
                                    <i class="fas fa-eye"></i> Preview Result
                                </button>
                            </div>
                            <div class="preprocess-preview" id="preprocess-preview" style="display: none;">
                                <img id="preprocess-image" alt="Preprocessing preview">
                            </div>
                        </div>
                    </div>

                    <!-- Step 3: OCR Processing -->
                    <div class="workflow-step" id="step-ocr">
                        <div class="step-header">
                            <span class="step-number">3</span>
                            <h3>OCR Processing</h3>
                        </div>
                        <div class="ocr-options">
                            <div class="option-row">
                                <div class="option-group">
                                    <label for="ocr-mode">Processing Mode:</label>
                                    <select id="ocr-mode" class="form-control">
                                        <option value="auto">Auto (Recommended)</option>
                                        <option value="text">Text Extraction Only</option>
                                        <option value="format">Preserve Formatting</option>
                                        <option value="fine-grained">Region-based</option>
                                    </select>
                                </div>
                                <div class="option-group">
                                    <label for="ocr-backend">OCR Engine:</label>
                                    <select id="ocr-backend" class="form-control">
                                        <option value="auto">Auto-Select Best</option>
                                        <option value="deepseek-ocr">DeepSeek-OCR (Complex docs)</option>
                                        <option value="florence-2">Florence-2 (Layout analysis)</option>
                                        <option value="pp-ocrv5">PP-OCRv5 (Industrial)</option>
                                        <option value="easyocr">EasyOCR (Handwriting)</option>
                                        <option value="tesseract">Tesseract (Legacy)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="advanced-options" id="advanced-options" style="display: none;">
                                <div class="option-row">
                                    <div class="option-group">
                                        <label for="ocr-language">Language:</label>
                                        <select id="ocr-language" class="form-control">
                                            <option value="auto">Auto-detect</option>
                                            <option value="en">English</option>
                                            <option value="es">Spanish</option>
                                            <option value="fr">French</option>
                                            <option value="de">German</option>
                                            <option value="zh">Chinese</option>
                                            <option value="ja">Japanese</option>
                                        </select>
                                    </div>
                                    <div class="option-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="enable-analysis">
                                            <span class="checkmark"></span>
                                            Enable document analysis
                                        </label>
                                    </div>
                                </div>
                            </div>
                            <button class="btn btn-link" onclick="toggleAdvancedOptions()">
                                <i class="fas fa-sliders-h"></i> Advanced Options
                            </button>
                        </div>
                    </div>

                    <!-- Step 4: Results & Analysis -->
                    <div class="workflow-step" id="step-results">
                        <div class="step-header">
                            <span class="step-number">4</span>
                            <h3>Results & Analysis</h3>
                        </div>
                        <div class="results-container">
                            <!-- Processing Status -->
                            <div class="processing-status" id="processing-status" style="display: none;">
                                <div class="status-card">
                                    <div class="status-header">
                                        <i class="fas fa-cog fa-spin"></i>
                                        <span>Processing document...</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill" id="progress-fill"></div>
                                    </div>
                                    <div class="status-details" id="status-details"></div>
                                </div>
                            </div>

                            <!-- Quality Metrics -->
                            <div class="quality-metrics" id="quality-metrics" style="display: none;">
                                <div class="metrics-grid">
                                    <div class="metric-card">
                                        <div class="metric-icon">
                                            <i class="fas fa-tachometer-alt"></i>
                                        </div>
                                        <div class="metric-content">
                                            <div class="metric-value" id="quality-score">-</div>
                                            <div class="metric-label">Quality Score</div>
                                        </div>
                                    </div>
                                    <div class="metric-card">
                                        <div class="metric-icon">
                                            <i class="fas fa-clock"></i>
                                        </div>
                                        <div class="metric-content">
                                            <div class="metric-value" id="processing-time">-</div>
                                            <div class="metric-label">Processing Time</div>
                                        </div>
                                    </div>
                                    <div class="metric-card">
                                        <div class="metric-icon">
                                            <i class="fas fa-font"></i>
                                        </div>
                                        <div class="metric-content">
                                            <div class="metric-value" id="text-confidence">-</div>
                                            <div class="metric-label">Text Confidence</div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Results Tabs -->
                            <div class="results-viewer" id="results-viewer" style="display: none;">
                                <div class="results-tabs">
                                    <button class="tab-btn active" onclick="showResultTab('text')">
                                        <i class="fas fa-file-alt"></i> Text
                                    </button>
                                    <button class="tab-btn" onclick="showResultTab('structured')">
                                        <i class="fas fa-table"></i> Structured Data
                                    </button>
                                    <button class="tab-btn" onclick="showResultTab('analysis')">
                                        <i class="fas fa-chart-bar"></i> Analysis
                                    </button>
                                    <button class="tab-btn" onclick="showResultTab('export')">
                                        <i class="fas fa-download"></i> Export
                                    </button>
                                </div>

                                <div class="tab-content">
                                    <!-- Text Results -->
                                    <div id="text-tab" class="result-panel active">
                                        <div class="text-controls">
                                            <button class="btn btn-sm" onclick="copyText()">
                                                <i class="fas fa-copy"></i> Copy
                                            </button>
                                            <button class="btn btn-sm" onclick="downloadText()">
                                                <i class="fas fa-download"></i> Download
                                            </button>
                                        </div>
                                        <pre id="text-content" class="text-content"></pre>
                                    </div>

                                    <!-- Structured Data -->
                                    <div id="structured-tab" class="result-panel">
                                        <div class="structured-data" id="structured-content">
                                            <!-- Tables, forms, and other structured elements -->
                                        </div>
                                    </div>

                                    <!-- Analysis -->
                                    <div id="analysis-tab" class="result-panel">
                                        <div class="analysis-content" id="analysis-content">
                                            <!-- Document layout analysis, quality metrics, etc. -->
                                        </div>
                                    </div>

                                    <!-- Export -->
                                    <div id="export-tab" class="result-panel">
                                        <div class="export-options">
                                            <div class="export-group">
                                                <h4>Text Formats</h4>
                                                <button class="btn btn-outline" onclick="exportAs('txt')">
                                                    <i class="fas fa-file-alt"></i> Plain Text
                                                </button>
                                                <button class="btn btn-outline" onclick="exportAs('docx')">
                                                    <i class="fas fa-file-word"></i> Word Document
                                                </button>
                                            </div>
                                            <div class="export-group">
                                                <h4>Rich Formats</h4>
                                                <button class="btn btn-outline" onclick="exportAs('pdf')">
                                                    <i class="fas fa-file-pdf"></i> Searchable PDF
                                                </button>
                                                <button class="btn btn-outline" onclick="exportAs('html')">
                                                    <i class="fas fa-code"></i> HTML
                                                </button>
                                            </div>
                                            <div class="export-group">
                                                <h4>Data Formats</h4>
                                                <button class="btn btn-outline" onclick="exportAs('json')">
                                                    <i class="fas fa-brackets-curly"></i> JSON
                                                </button>
                                                <button class="btn btn-outline" onclick="exportAs('xml')">
                                                    <i class="fas fa-code-branch"></i> XML
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="workflow-actions">
                    <button class="btn btn-secondary" onclick="resetWorkflow()">
                        <i class="fas fa-redo"></i> Start Over
                    </button>
                    <button class="btn btn-primary" onclick="processCurrentStep()" id="process-btn">
                        <i class="fas fa-play"></i> Process Document
                    </button>
                </div>
            </section>

            <!-- Batch Processing Section -->
            <section id="batch-section" class="content-section">
                <div class="section-header">
                    <h2><i class="fas fa-layer-group"></i> Intelligent Batch Processing</h2>
                    <p>Process multiple documents with automatic optimization and quality control</p>
                </div>

                <div class="batch-workflow">
                    <!-- File Upload -->
                    <div class="batch-upload-zone">
                        <div class="upload-area" id="batch-upload-area">
                            <div class="upload-content">
                                <i class="fas fa-folder-plus"></i>
                                <h3>Drop multiple documents here</h3>
                                <p>or <button class="link-btn" onclick="document.getElementById('batch-file-input').click()">select files</button></p>
                                <input type="file" id="batch-file-input" multiple accept=".pdf,.png,.jpg,.jpeg,.tiff,.bmp,.cbz,.cbr" style="display: none;">
                            </div>
                        </div>
                        <div id="batch-file-list" class="file-queue">
                            <!-- File list will be populated here -->
                        </div>
                    </div>

                    <!-- Processing Options -->
                    <div class="batch-options-panel">
                        <div class="options-header">
                            <h3>Processing Strategy</h3>
                        </div>
                        <div class="strategy-options">
                            <div class="strategy-card active" data-strategy="auto">
                                <div class="strategy-icon">
                                    <i class="fas fa-brain"></i>
                                </div>
                                <div class="strategy-content">
                                    <h4>Intelligent Auto</h4>
                                    <p>Automatically optimize for each document type</p>
                                </div>
                            </div>
                            <div class="strategy-card" data-strategy="quality">
                                <div class="strategy-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="strategy-content">
                                    <h4>Quality Focused</h4>
                                    <p>Multiple attempts to achieve high accuracy</p>
                                </div>
                            </div>
                            <div class="strategy-card" data-strategy="speed">
                                <div class="strategy-icon">
                                    <i class="fas fa-tachometer-alt"></i>
                                </div>
                                <div class="strategy-content">
                                    <h4>Speed Optimized</h4>
                                    <p>Fast processing with good accuracy</p>
                                </div>
                            </div>
                            <div class="strategy-card" data-strategy="custom">
                                <div class="strategy-icon">
                                    <i class="fas fa-cogs"></i>
                                </div>
                                <div class="strategy-content">
                                    <h4>Custom Pipeline</h4>
                                    <p>Use a predefined processing pipeline</p>
                                </div>
                            </div>
                        </div>

                        <div class="advanced-batch-options">
                            <div class="option-row">
                                <div class="option-group">
                                    <label for="batch-quality-threshold">Quality Threshold:</label>
                                    <input type="range" id="batch-quality-threshold" min="0.5" max="1.0" step="0.1" value="0.8">
                                    <span id="quality-value">80%</span>
                                </div>
                                <div class="option-group">
                                    <label for="batch-concurrent">Concurrent Jobs:</label>
                                    <select id="batch-concurrent" class="form-control">
                                        <option value="1">1 (Sequential)</option>
                                        <option value="2">2</option>
                                        <option value="3" selected>3</option>
                                        <option value="5">5</option>
                                        <option value="10">10</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Processing Dashboard -->
                    <div class="batch-dashboard" id="batch-dashboard" style="display: none;">
                        <div class="dashboard-header">
                            <h3>Processing Dashboard</h3>
                            <div class="dashboard-controls">
                                <button class="btn btn-outline" onclick="pauseBatch()">
                                    <i class="fas fa-pause"></i> Pause
                                </button>
                                <button class="btn btn-outline" onclick="stopBatch()">
                                    <i class="fas fa-stop"></i> Stop
                                </button>
                            </div>
                        </div>

                        <!-- Progress Overview -->
                        <div class="progress-overview">
                            <div class="progress-metrics">
                                <div class="metric">
                                    <div class="metric-value" id="total-files">0</div>
                                    <div class="metric-label">Total Files</div>
                                </div>
                                <div class="metric">
                                    <div class="metric-value" id="processed-files">0</div>
                                    <div class="metric-label">Processed</div>
                                </div>
                                <div class="metric">
                                    <div class="metric-value" id="successful-files">0</div>
                                    <div class="metric-label">Successful</div>
                                </div>
                                <div class="metric">
                                    <div class="metric-value" id="failed-files">0</div>
                                    <div class="metric-label">Failed</div>
                                </div>
                            </div>
                            <div class="overall-progress">
                                <div class="progress-bar">
                                    <div class="progress-fill" id="batch-progress-fill"></div>
                                </div>
                                <div class="progress-text">
                                    <span id="progress-percentage">0%</span> Complete
                                </div>
                            </div>
                        </div>

                        <!-- File Status Table -->
                        <div class="file-status-table">
                            <table id="batch-status-table">
                                <thead>
                                    <tr>
                                        <th>File</th>
                                        <th>Status</th>
                                        <th>Quality</th>
                                        <th>Time</th>
                                        <th>Actions</th>
                                    </tr>
                                </thead>
                                <tbody id="batch-status-body">
                                    <!-- Status rows will be populated here -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- Results Summary -->
                    <div class="batch-results" id="batch-results" style="display: none;">
                        <div class="results-summary">
                            <h3>Batch Processing Complete</h3>
                            <div class="summary-metrics">
                                <div class="metric-card">
                                    <div class="metric-icon success">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                    <div class="metric-content">
                                        <div class="metric-value" id="summary-successful">0</div>
                                        <div class="metric-label">Successful</div>
                                    </div>
                                </div>
                                <div class="metric-card">
                                    <div class="metric-icon warning">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <div class="metric-content">
                                        <div class="metric-value" id="summary-failed">0</div>
                                        <div class="metric-label">Failed</div>
                                    </div>
                                </div>
                                <div class="metric-card">
                                    <div class="metric-icon info">
                                        <i class="fas fa-clock"></i>
                                    </div>
                                    <div class="metric-content">
                                        <div class="metric-value" id="summary-time">-</div>
                                        <div class="metric-label">Total Time</div>
                                    </div>
                                </div>
                                <div class="metric-card">
                                    <div class="metric-icon primary">
                                        <i class="fas fa-chart-line"></i>
                                    </div>
                                    <div class="metric-content">
                                        <div class="metric-value" id="summary-quality">-</div>
                                        <div class="metric-label">Avg Quality</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="batch-actions">
                            <button class="btn btn-primary" onclick="downloadBatchResults()">
                                <i class="fas fa-download"></i> Download All Results
                            </button>
                            <button class="btn btn-outline" onclick="exportBatchReport()">
                                <i class="fas fa-file-alt"></i> Generate Report
                            </button>
                            <button class="btn btn-outline" onclick="retryFailedFiles()">
                                <i class="fas fa-redo"></i> Retry Failed
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Batch Action Buttons -->
                <div class="batch-actions">
                    <button class="btn btn-secondary" onclick="clearBatch()">
                        <i class="fas fa-trash"></i> Clear All
                    </button>
                    <button class="btn btn-primary" onclick="startBatchProcessing()" id="start-batch-btn">
                        <i class="fas fa-play-circle"></i> Start Batch Processing
                    </button>
                </div>
            </section>

            <!-- Image Preprocessing Section -->
            <section id="preprocessing-section" class="content-section">
                <div class="section-header">
                    <h2><i class="fas fa-magic"></i> Image Preprocessing</h2>
                    <p>Enhance image quality before OCR processing</p>
                </div>

                <div class="preprocessing-workspace">
                    <!-- Image Upload -->
                    <div class="preprocessing-upload">
                        <div class="upload-area" id="preprocessing-upload-area">
                            <div class="upload-content">
                                <i class="fas fa-image"></i>
                                <h3>Upload image for preprocessing</h3>
                                <input type="file" id="preprocessing-file-input" accept=".png,.jpg,.jpeg,.tiff,.bmp" style="display: none;">
                                <button class="btn btn-primary" onclick="document.getElementById('preprocessing-file-input').click()">
                                    <i class="fas fa-folder-open"></i> Choose Image
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Preprocessing Tools -->
                    <div class="preprocessing-tools" id="preprocessing-tools" style="display: none;">
                        <div class="tools-grid">
                            <div class="tool-card" data-tool="deskew">
                                <div class="tool-icon">
                                    <i class="fas fa-compass"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Deskew</h4>
                                    <p>Straighten rotated images</p>
                                    <button class="btn btn-sm btn-outline" onclick="applyPreprocessing('deskew')">
                                        Apply
                                    </button>
                                </div>
                            </div>

                            <div class="tool-card" data-tool="enhance">
                                <div class="tool-icon">
                                    <i class="fas fa-sun"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Enhance</h4>
                                    <p>Improve contrast and quality</p>
                                    <button class="btn btn-sm btn-outline" onclick="applyPreprocessing('enhance')">
                                        Apply
                                    </button>
                                </div>
                            </div>

                            <div class="tool-card" data-tool="crop">
                                <div class="tool-icon">
                                    <i class="fas fa-crop"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Auto-Crop</h4>
                                    <p>Remove borders and margins</p>
                                    <button class="btn btn-sm btn-outline" onclick="applyPreprocessing('crop')">
                                        Apply
                                    </button>
                                </div>
                            </div>

                            <div class="tool-card" data-tool="rotate">
                                <div class="tool-icon">
                                    <i class="fas fa-undo"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Rotate</h4>
                                    <p>Fix orientation</p>
                                    <button class="btn btn-sm btn-outline" onclick="applyPreprocessing('rotate')">
                                        Apply
                                    </button>
                                </div>
                            </div>

                            <div class="tool-card" data-tool="pipeline">
                                <div class="tool-icon">
                                    <i class="fas fa-list-check"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Full Pipeline</h4>
                                    <p>All preprocessing steps</p>
                                    <button class="btn btn-sm btn-primary" onclick="applyPreprocessing('pipeline')">
                                        Run All
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Before/After Comparison -->
                    <div class="comparison-view" id="comparison-view" style="display: none;">
                        <div class="comparison-header">
                            <h3>Before & After</h3>
                            <div class="comparison-controls">
                                <button class="btn btn-sm" onclick="toggleSplitView()">
                                    <i class="fas fa-columns"></i> Split View
                                </button>
                                <button class="btn btn-sm" onclick="downloadProcessedImage()">
                                    <i class="fas fa-download"></i> Download
                                </button>
                            </div>
                        </div>

                        <div class="comparison-images">
                            <div class="image-panel">
                                <h4>Original</h4>
                                <img id="original-image" alt="Original image">
                            </div>
                            <div class="image-panel">
                                <h4>Processed</h4>
                                <img id="processed-image" alt="Processed image">
                            </div>
                        </div>

                        <div class="processing-metrics" id="processing-metrics">
                            <!-- Metrics will be shown here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Document Analysis Section -->
            <section id="analysis-section" class="content-section">
                <div class="section-header">
                    <h2><i class="fas fa-search-plus"></i> Document Structure Analysis</h2>
                    <p>Extract tables, forms, layout information, and document metadata</p>
                </div>

                <div class="analysis-workspace">
                    <!-- Document Upload -->
                    <div class="analysis-upload">
                        <div class="upload-area" id="analysis-upload-area">
                            <div class="upload-content">
                                <i class="fas fa-file-contract"></i>
                                <h3>Upload document for analysis</h3>
                                <input type="file" id="analysis-file-input" accept=".pdf,.png,.jpg,.jpeg,.tiff,.bmp" style="display: none;">
                                <button class="btn btn-primary" onclick="document.getElementById('analysis-file-input').click()">
                                    <i class="fas fa-folder-open"></i> Choose Document
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Analysis Tools -->
                    <div class="analysis-tools" id="analysis-tools" style="display: none;">
                        <div class="tools-grid">
                            <div class="tool-card" data-tool="layout">
                                <div class="tool-icon">
                                    <i class="fas fa-th-large"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Layout Analysis</h4>
                                    <p>Detect headers, paragraphs, sections</p>
                                    <button class="btn btn-sm btn-outline" onclick="runAnalysis('layout')">
                                        Analyze
                                    </button>
                                </div>
                            </div>

                            <div class="tool-card" data-tool="tables">
                                <div class="tool-icon">
                                    <i class="fas fa-table"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Table Extraction</h4>
                                    <p>Extract tabular data from documents</p>
                                    <button class="btn btn-sm btn-outline" onclick="runAnalysis('tables')">
                                        Extract
                                    </button>
                                </div>
                            </div>

                            <div class="tool-card" data-tool="forms">
                                <div class="tool-icon">
                                    <i class="fas fa-clipboard-check"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Form Detection</h4>
                                    <p>Find form fields and checkboxes</p>
                                    <button class="btn btn-sm btn-outline" onclick="runAnalysis('forms')">
                                        Detect
                                    </button>
                                </div>
                            </div>

                            <div class="tool-card" data-tool="reading_order">
                                <div class="tool-icon">
                                    <i class="fas fa-route"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Reading Order</h4>
                                    <p>Determine logical text flow</p>
                                    <button class="btn btn-sm btn-outline" onclick="runAnalysis('reading_order')">
                                        Analyze
                                    </button>
                                </div>
                            </div>

                            <div class="tool-card" data-tool="classification">
                                <div class="tool-icon">
                                    <i class="fas fa-tags"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Document Type</h4>
                                    <p>Classify document type</p>
                                    <button class="btn btn-sm btn-outline" onclick="runAnalysis('classification')">
                                        Classify
                                    </button>
                                </div>
                            </div>

                            <div class="tool-card" data-tool="metadata">
                                <div class="tool-icon">
                                    <i class="fas fa-info-circle"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Metadata Extraction</h4>
                                    <p>Extract dates, names, numbers</p>
                                    <button class="btn btn-sm btn-outline" onclick="runAnalysis('metadata')">
                                        Extract
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Analysis Results -->
                    <div class="analysis-results" id="analysis-results" style="display: none;">
                        <div class="results-header">
                            <h3>Analysis Results</h3>
                            <div class="results-controls">
                                <button class="btn btn-sm" onclick="exportAnalysis()">
                                    <i class="fas fa-download"></i> Export
                                </button>
                            </div>
                        </div>

                        <div class="analysis-content" id="analysis-content">
                            <!-- Analysis results will be displayed here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Quality Assessment Section -->
            <section id="quality-section" class="content-section">
                <div class="section-header">
                    <h2><i class="fas fa-chart-line"></i> OCR Quality Assessment</h2>
                    <p>Evaluate and compare OCR accuracy across different engines</p>
                </div>

                <div class="quality-workspace">
                    <!-- Quality Tools -->
                    <div class="quality-tools">
                        <div class="tools-grid">
                            <div class="tool-card" data-tool="single_assess">
                                <div class="tool-icon">
                                    <i class="fas fa-file-alt"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Single Assessment</h4>
                                    <p>Analyze one OCR result</p>
                                    <button class="btn btn-sm btn-outline" onclick="showQualityTool('single_assess')">
                                        Analyze
                                    </button>
                                </div>
                            </div>

                            <div class="tool-card" data-tool="backend_compare">
                                <div class="tool-icon">
                                    <i class="fas fa-balance-scale"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Backend Comparison</h4>
                                    <p>Compare OCR engines</p>
                                    <button class="btn btn-sm btn-outline" onclick="showQualityTool('backend_compare')">
                                        Compare
                                    </button>
                                </div>
                            </div>

                            <div class="tool-card" data-tool="accuracy_validate">
                                <div class="tool-icon">
                                    <i class="fas fa-check-double"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Accuracy Validation</h4>
                                    <p>Validate against ground truth</p>
                                    <button class="btn btn-sm btn-outline" onclick="showQualityTool('accuracy_validate')">
                                        Validate
                                    </button>
                                </div>
                            </div>

                            <div class="tool-card" data-tool="image_quality">
                                <div class="tool-icon">
                                    <i class="fas fa-image"></i>
                                </div>
                                <div class="tool-content">
                                    <h4>Image Quality Check</h4>
                                    <p>Analyze image quality factors</p>
                                    <button class="btn btn-sm btn-outline" onclick="showQualityTool('image_quality')">
                                        Check
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Quality Analysis Panel -->
                    <div class="quality-panel" id="quality-panel" style="display: none;">
                        <div class="panel-content" id="quality-panel-content">
                            <!-- Quality analysis content will be loaded here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Custom Pipelines Section -->
            <section id="pipelines-section" class="content-section">
                <div class="section-header">
                    <h2><i class="fas fa-project-diagram"></i> Custom Processing Pipelines</h2>
                    <p>Create and execute automated document processing workflows</p>
                </div>

                <div class="pipelines-workspace">
                    <!-- Pipeline Builder -->
                    <div class="pipeline-builder">
                        <div class="builder-header">
                            <h3>Pipeline Builder</h3>
                            <button class="btn btn-outline" onclick="createNewPipeline()">
                                <i class="fas fa-plus"></i> New Pipeline
                            </button>
                        </div>

                        <div class="pipeline-canvas" id="pipeline-canvas">
                            <div class="canvas-placeholder">
                                <i class="fas fa-project-diagram"></i>
                                <p>Drag and drop processing steps to build your pipeline</p>
                            </div>
                        </div>

                        <div class="pipeline-steps">
                            <h4>Available Steps</h4>
                            <div class="steps-palette">
                                <div class="step-item" draggable="true" data-step="deskew_image">
                                    <i class="fas fa-compass"></i> Deskew Image
                                </div>
                                <div class="step-item" draggable="true" data-step="enhance_image">
                                    <i class="fas fa-sun"></i> Enhance Image
                                </div>
                                <div class="step-item" draggable="true" data-step="process_document">
                                    <i class="fas fa-brain"></i> OCR Processing
                                </div>
                                <div class="step-item" draggable="true" data-step="assess_ocr_quality">
                                    <i class="fas fa-chart-line"></i> Quality Assessment
                                </div>
                                <div class="step-item" draggable="true" data-step="convert_image_format">
                                    <i class="fas fa-exchange-alt"></i> Format Conversion
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Saved Pipelines -->
                    <div class="saved-pipelines">
                        <h3>Saved Pipelines</h3>
                        <div class="pipelines-list" id="pipelines-list">
                            <!-- Saved pipelines will be listed here -->
                        </div>
                    </div>
                </div>
            </section>

            <!-- Scanner Control Section -->
            <section id="scanner-section" class="content-section">
                <div class="section-header">
                    <h2><i class="fas fa-print"></i> Scanner Control</h2>
                    <p>Direct control of connected scanners and scanning hardware</p>
                </div>

                <div class="scanner-workspace">
                    <!-- Scanner Discovery -->
                    <div class="scanner-discovery">
                        <button class="btn btn-primary" onclick="discoverScanners()">
                            <i class="fas fa-search"></i> Discover Scanners
                        </button>
                        <div id="scanner-list" class="scanner-grid">
                            <!-- Scanners will be displayed here -->
                        </div>
                    </div>

                    <!-- Scanner Control Panel -->
                    <div class="scanner-control" id="scanner-control" style="display: none;">
                        <div class="control-header">
                            <h3 id="scanner-name">Scanner Control</h3>
                            <div class="scanner-status">
                                <span class="status-badge" id="scanner-status">Ready</span>
                            </div>
                        </div>

                        <!-- Scan Settings -->
                        <div class="scan-settings">
                            <div class="settings-grid">
                                <div class="setting-group">
                                    <label for="scan-dpi">Resolution (DPI)</label>
                                    <select id="scan-dpi" class="form-control">
                                        <option value="150">150 DPI</option>
                                        <option value="200">200 DPI</option>
                                        <option value="300" selected>300 DPI</option>
                                        <option value="600">600 DPI</option>
                                    </select>
                                </div>

                                <div class="setting-group">
                                    <label for="scan-color">Color Mode</label>
                                    <select id="scan-color" class="form-control">
                                        <option value="Color" selected>Color</option>
                                        <option value="Grayscale">Grayscale</option>
                                        <option value="BlackWhite">Black & White</option>
                                    </select>
                                </div>

                                <div class="setting-group">
                                    <label for="scan-size">Paper Size</label>
                                    <select id="scan-size" class="form-control">
                                        <option value="A4" selected>A4</option>
                                        <option value="Letter">Letter</option>
                                        <option value="Legal">Legal</option>
                                    </select>
                                </div>

                                <div class="setting-group">
                                    <label for="scan-source">Scan Source</label>
                                    <select id="scan-source" class="form-control">
                                        <option value="Flatbed" selected>Flatbed</option>
                                        <option value="ADF">Auto Document Feeder</option>
                                        <option value="Duplex">Duplex</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Advanced Settings -->
                            <div class="advanced-settings" id="advanced-scan-settings" style="display: none;">
                                <h4>Advanced Settings</h4>
                                <div class="settings-grid">
                                    <div class="setting-group">
                                        <label for="brightness">Brightness</label>
                                        <input type="range" id="brightness" min="-1000" max="1000" value="0">
                                        <span id="brightness-value">0</span>
                                    </div>

                                    <div class="setting-group">
                                        <label for="contrast">Contrast</label>
                                        <input type="range" id="contrast" min="-1000" max="1000" value="0">
                                        <span id="contrast-value">0</span>
                                    </div>
                                </div>
                            </div>

                            <button class="btn btn-link" onclick="toggleAdvancedScanSettings()">
                                <i class="fas fa-sliders-h"></i> Advanced Settings
                            </button>
                        </div>

                        <!-- Scan Actions -->
                        <div class="scan-actions">
                            <button class="btn btn-outline" onclick="previewScan()">
                                <i class="fas fa-eye"></i> Preview Scan
                            </button>
                            <button class="btn btn-success" onclick="scanDocument()" id="scan-btn">
                                <i class="fas fa-camera"></i> Scan Document
                            </button>
                            <button class="btn btn-primary" onclick="scanBatch()" id="batch-scan-btn" style="display: none;">
                                <i class="fas fa-layer-group"></i> Batch Scan
                            </button>
                        </div>

                        <!-- Scan Preview -->
                        <div class="scan-preview" id="scan-preview" style="display: none;">
                            <h4>Scan Preview</h4>
                            <img id="preview-image" alt="Scan preview">
                            <div class="preview-actions">
                                <button class="btn btn-sm btn-outline" onclick="acceptScan()">
                                    <i class="fas fa-check"></i> Accept
                                </button>
                                <button class="btn btn-sm btn-outline" onclick="rescan()">
                                    <i class="fas fa-redo"></i> Rescan
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- JavaScript -->
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/components/prism-core.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="/static/js/app.js"></script>
</body>
</html>

    <script src="/static/js/app.js"></script>
</body>
</html>






